import{a as z,Q as p,b as o,j as a,d as T,F as l,e as V,c as R,B as W,r as m,g as G,u as I,R as O,C as U,L as q,m as Q}from"./index.3b1adc00.js";import{M as Z}from"./index.ef0c42f4.js";import{u as J,c as K,a as E,b as P}from"./index.esm.997dd77f.js";import{M as F}from"./Modal.63283be8.js";function X({onClose:d,item:r,mutate:i,setShowModalUpadate:g}){var w,h,b,L,f,N,x,v,t,c,M,j,A,D,$;const e=J({initialValues:{nome:r==null?void 0:r.nome,fotoUrl:r==null?void 0:r.fotoUrl,descricao:r==null?void 0:r.descricao,data:r==null?void 0:r.data,organizador:r==null?void 0:r.organizador},validationSchema:K({nome:E().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:E().required("Este campo \xE9 obrigat\xF3rio"),descricao:E().required("Este campo \xE9 obrigat\xF3rio"),data:P().min(new Date,"A data deve ser maior ou igual ao dia de hoje").required("Este campo \xE9 obrigat\xF3rio"),organizador:E().required("Este campo \xE9 obrigat\xF3rio")}),onSubmit:async n=>{var u,H,S,B;if((r==null?void 0:r.fotoUrl)===(n==null?void 0:n.fotoUrl))try{await z.put(`/activity/put/${r==null?void 0:r.id}`,n)&&(p.success("Actividade actualizada com sucesso"),i(),g(!1))}catch(s){p.error((H=(u=s==null?void 0:s.response)==null?void 0:u.data)==null?void 0:H.message)}else try{const s=new FormData;s.append("file",n==null?void 0:n.fotoUrl[0]);const y=await C(s);y&&(n={...n,fotoUrl:y==null?void 0:y.id},await z.put(`/activity/put/${r==null?void 0:r.id}`,n)&&(p.success("Actividade actualizada com sucesso"),g(!1)))}catch(s){p.error((B=(S=s==null?void 0:s.response)==null?void 0:S.data)==null?void 0:B.message)}}});async function C(n){return(await z.post("/file",n)).data}return o(F,{show:!0,onHide:d,children:[a(F.Header,{closeButton:!0,children:a(F.Title,{children:"Actualizar Actividade"})}),a(T.Body,{style:{width:"100%",padding:"1rem 1rem",display:"flex"},children:o(l,{onSubmit:e==null?void 0:e.handleSubmit,encType:"multipart/form-data",children:[a(V,{children:o(R,{xs:12,sm:12,md:12,lg:50,xl:20,className:"mb-3 ",children:[o("div",{children:[a(l.Label,{htmlFor:"validationCustom05",children:"Nome"}),a(l.Control,{onChange:e.handleChange,name:"nome",value:e.values.nome,type:"text",id:"nome"}),((w=e==null?void 0:e.touched)==null?void 0:w.nome)&&((h=e==null?void 0:e.errors)==null?void 0:h.nome)?a("label",{className:"mt-1 text-danger",children:(b=e==null?void 0:e.errors)==null?void 0:b.nome}):null]}),o("div",{children:[a(l.Label,{htmlFor:"validationCustom05",children:"Organizador"}),a(l.Control,{onChange:e.handleChange,name:"organizador",value:e.values.organizador,type:"text",id:"organizador"}),((L=e==null?void 0:e.touched)==null?void 0:L.organizador)&&((f=e==null?void 0:e.errors)==null?void 0:f.organizador)?a("label",{className:"mt-1 text-danger",children:(N=e==null?void 0:e.errors)==null?void 0:N.organizador}):null]}),o("div",{children:[a(l.Label,{htmlFor:"validationCustom05",children:"Data"}),a(l.Control,{onChange:e.handleChange,name:"data",value:e.values.data,type:"date",id:"data"}),((x=e==null?void 0:e.touched)==null?void 0:x.data)&&((v=e==null?void 0:e.errors)==null?void 0:v.data)?a("label",{className:"mt-1 text-danger",children:(t=e==null?void 0:e.errors)==null?void 0:t.data}):null]}),o("div",{children:[o(l.Group,{className:"mb-3 form-group mt-1",children:[a(l.Label,{htmlFor:"exampleFormControlTextarea1",children:"Descri\xE7\xE3o"}),a(l.Control,{as:"textarea",id:"descricao",value:e.values.descricao,name:"descricao",onChange:e.handleChange,rows:"5"})]}),((c=e==null?void 0:e.touched)==null?void 0:c.descricao)&&((M=e==null?void 0:e.errors)==null?void 0:M.descricao)?a("label",{className:"text-danger",children:(j=e==null?void 0:e.errors)==null?void 0:j.descricao}):null]}),o("div",{children:[o(l.Group,{className:"mb-3 form-group mt-2",children:[a(l.Label,{className:"custom-file-input",children:"Escolha o ficheiro"}),a(l.Control,{type:"file",id:"fotoUrl",name:"fotoUrl",onChange:n=>{var u;e.setFieldValue("fotoUrl",(u=n==null?void 0:n.currentTarget)==null?void 0:u.files)}})]}),((A=e==null?void 0:e.touched)==null?void 0:A.fotoUrl)&&((D=e==null?void 0:e.errors)==null?void 0:D.fotoUrl)?a("label",{className:"mt-1 text-danger",children:($=e==null?void 0:e.errors)==null?void 0:$.fotoUrl}):null]})]})}),o(F.Footer,{children:[a(W,{variant:"secondary",onClick:d,children:"Cancelar"}),a(W,{type:"submit",children:"Actualizar"})]})]})})]})}const Y=m.exports.memo(()=>{var x,v;const d=G(),{data:r}=I(`/user/list/${d==null?void 0:d.sub}`),[i,g]=m.exports.useState({});console.log(r==null?void 0:r.Escola);const[e,C]=m.exports.useState(!1),[w,h]=m.exports.useState(!1);function b(){Q(`/user/list/${d==null?void 0:d.sub}`)}async function L(t){try{const c=await z.delete(`activity/delete/${t}`);c!=null&&c.data&&(p.success("deletado com sucesso!"),b(),C(!1))}catch{p.error("Erro inesperado")}}function f(t){C(!0),g(t)}function N(t){h(!0),g(t)}return o(m.exports.Fragment,{children:[w?a(X,{onClose:()=>h(!1),setShowModalUpadate:h,mutate:b,item:i}):null,e?a(Z,{onClose:()=>C(!1),onConfirm:()=>L(i==null?void 0:i.id),item:i,desc:"curso de"}):null,a(O,{children:a(R,{sm:"12",children:o(U,{children:[a(U.Header,{className:"d-flex justify-content-between",children:a("div",{className:"header-title",children:a("h4",{className:"card-title",children:"Listagem de Actividades"})})}),a(U.Body,{className:"px-0",children:a("div",{className:"table-responsive",children:o("table",{id:"user-list-table",className:"table table-striped",role:"grid","data-toggle":"data-table",children:[a("thead",{children:o("tr",{className:"ligth",children:[a("th",{children:"Nome "}),a("th",{children:"Organizador"}),a("th",{children:"Data"}),a("th",{"min-width":"100px",children:"Ac\xE7\xE3o"})]})}),a("tbody",{children:(v=(x=r==null?void 0:r.Escola)==null?void 0:x.actividade)==null?void 0:v.map((t,c)=>o("tr",{children:[a("td",{children:t.nome}),a("td",{children:t==null?void 0:t.organizador}),a("td",{children:t==null?void 0:t.data}),a("td",{children:o("div",{className:"flex align-items-center list-user-action",children:[a(q,{onClick:()=>N(t),className:"btn btn-sm btn-icon btn-warning","data-toggle":"tooltip","data-placement":"top",title:"","data-original-title":"Edit",to:"#",children:a("span",{className:"btn-inner",children:o("svg",{width:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a("path",{d:"M11.4925 2.78906H7.75349C4.67849 2.78906 2.75049 4.96606 2.75049 8.04806V16.3621C2.75049 19.4441 4.66949 21.6211 7.75349 21.6211H16.5775C19.6625 21.6211 21.5815 19.4441 21.5815 16.3621V12.3341",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),a("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.82812 10.921L16.3011 3.44799C17.2321 2.51799 18.7411 2.51799 19.6721 3.44799L20.8891 4.66499C21.8201 5.59599 21.8201 7.10599 20.8891 8.03599L13.3801 15.545C12.9731 15.952 12.4211 16.181 11.8451 16.181H8.09912L8.19312 12.401C8.20712 11.845 8.43412 11.315 8.82812 10.921Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),a("path",{d:"M15.1655 4.60254L19.7315 9.16854",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})})," ",a(q,{onClick:()=>f(t),className:"btn btn-sm btn-icon btn-danger","data-toggle":"tooltip","data-placement":"top",title:"","data-original-title":"Delete",to:"#",children:a("span",{className:"btn-inner",children:o("svg",{width:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",children:[a("path",{d:"M19.3248 9.46826C19.3248 9.46826 18.7818 16.2033 18.4668 19.0403C18.3168 20.3953 17.4798 21.1893 16.1088 21.2143C13.4998 21.2613 10.8878 21.2643 8.27979 21.2093C6.96079 21.1823 6.13779 20.3783 5.99079 19.0473C5.67379 16.1853 5.13379 9.46826 5.13379 9.46826",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),a("path",{d:"M20.708 6.23975H3.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),a("path",{d:"M17.4406 6.23973C16.6556 6.23973 15.9796 5.68473 15.8256 4.91573L15.5826 3.69973C15.4326 3.13873 14.9246 2.75073 14.3456 2.75073H10.1126C9.53358 2.75073 9.02558 3.13873 8.87558 3.69973L8.63258 4.91573C8.47858 5.68473 7.80258 6.23973 7.01758 6.23973",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})})," "]})})]},c))})]})})})]})})})]})});Y.displayName="ActividadeList";export{Y as default};
