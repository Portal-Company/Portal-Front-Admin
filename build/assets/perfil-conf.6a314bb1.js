import{g as Z,u as v,r as K,a as f,Q as O,j as r,R as _,c as oo,b as i,C as w,F as n}from"./index.3b1adc00.js";import{u as eo,c as ro,a as s}from"./index.esm.997dd77f.js";const mo=()=>{var y,D,T,q,L,S,z,$,V,G,j,k,P,H;const U=Z(),{data:E}=v(`/user/list/${U==null?void 0:U.sub}`),[e,lo]=K.exports.useState(E==null?void 0:E.Escola);K.exports.useState("A");const{data:b}=v("/province/list"),{data:I}=v("/county/list"),l=eo({initialValues:{nome:e==null?void 0:e.nome,nif:e==null?void 0:e.nif,logo:e==null?void 0:e.logo,fotoUrl:e==null?void 0:e.fotoUrl,contatoId:e==null?void 0:e.contatoId,email:(y=e==null?void 0:e.Contato)==null?void 0:y.email,numeroTelefone:(D=e==null?void 0:e.Contato)==null?void 0:D.numeroTelefone,endereco1:(T=e==null?void 0:e.Localizacao)==null?void 0:T.endereco1,provinciaId:(q=e==null?void 0:e.Localizacao)==null?void 0:q.provinciaId,municipioId:(L=e==null?void 0:e.Localizacao)==null?void 0:L.municipioId,escolaId:e==null?void 0:e.id,localizacaoId:(S=e==null?void 0:e.Localizacao)==null?void 0:S.id,descricao:(z=e==null?void 0:e.historial)==null?void 0:z.descricao,data:($=e==null?void 0:e.historial)==null?void 0:$.data,historialId:(V=e==null?void 0:e.historial)==null?void 0:V.id,fotoUrl1:(G=e==null?void 0:e.historial)==null?void 0:G.fotoUrl,fotoUrl2:(j=e==null?void 0:e.historial)==null?void 0:j.fotoUrl2,fotoUrl3:(k=e==null?void 0:e.historial)==null?void 0:k.fotoUrl3,fotoUrl4:(P=e==null?void 0:e.historial)==null?void 0:P.fotoUrl4,fundador:(H=e==null?void 0:e.historial)==null?void 0:H.fundador},validationSchema:ro({nome:s().required("Este campo \xE9 obrigat\xF3rio"),nif:s().required("Este campo \xE9 obrigat\xF3rio"),logo:s().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:s().required("Este campo \xE9 obrigat\xF3rio"),contatoId:s().required("Este campo \xE9 obrigat\xF3rio"),email:s().required("Este campo \xE9 obrigat\xF3rio"),numeroTelefone:s().required("Este campo \xE9 obrigat\xF3rio"),endereco1:s().required("Este campo \xE9 obrigat\xF3rio"),provinciaId:s().required("Este campo \xE9 obrigat\xF3rio"),escolaId:s().required("Este campo \xE9 obrigat\xF3rio"),descricao:s().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl1:s().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl2:s().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl3:s().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl4:s().required("Este campo \xE9 obrigat\xF3rio"),fundador:s().required("Este campo \xE9 obrigat\xF3rio"),data:s().required("Este campo \xE9 obrigat\xF3rio")}),onSubmit:async o=>{var R,A,B,M,Q,W;let c=o==null?void 0:o.contatoId;try{if(e!=null&&e.historial)if(((R=e==null?void 0:e.historial)==null?void 0:R.fotoUrl)===o.fotoUrl&&((A=e==null?void 0:e.historial)==null?void 0:A.fotoUrl2)===o.fotoUrl2&&((B=e==null?void 0:e.historial)==null?void 0:B.fotoUrl3)===o.fotoUrl3&&((M=e==null?void 0:e.historial)==null?void 0:M.fotoUrl4)===o.fotoUrl4){const m={fundador:o==null?void 0:o.fundador,descricao:o==null?void 0:o.descricao,escolaId:e==null?void 0:e.id},t=await f.put(`/history/put/${o==null?void 0:o.historialId}`,m)}else{const m=new FormData,t=new FormData,p=new FormData,g=new FormData;if(m.append("file",o==null?void 0:o.fotoUrl1[0]),t.append("file",o==null?void 0:o.fotoUrl2[0]),p.append("file",o==null?void 0:o.fotoUrl3[0]),g.append("file",o==null?void 0:o.fotoUrl4[0]),setTimeout(async()=>{const d=await a(m),u=await a(t),x=await a(p),N=await a(g)},2e3),fotoUrl1&&fotoUrl2&&fotoUrl3&&fotoUrl4){const d={fundador:o==null?void 0:o.fundador,descricao:o==null?void 0:o.descricao,escolaId:e==null?void 0:e.id,fotoUrl:fotoUrl1==null?void 0:fotoUrl1.id,fotoUrl2:fotoUrl2==null?void 0:fotoUrl2.id,fotoUrl3:fotoUrl3==null?void 0:fotoUrl3.id,fotoUrl4:fotoUrl4==null?void 0:fotoUrl4.id},u=await f.put(`/history/put/${o==null?void 0:o.historialId}`,d)}}else{const m=new FormData,t=new FormData,p=new FormData,g=new FormData;m.append("file",o==null?void 0:o.fotoUrl1[0]),t.append("file",o==null?void 0:o.fotoUrl2[0]),p.append("file",o==null?void 0:o.fotoUrl3[0]),g.append("file",o==null?void 0:o.fotoUrl4[0]);const d=await a(m),u=await a(t),x=await a(p),N=await a(g);if(d&&u&&x&&N){const Y={fundador:o==null?void 0:o.fundador,descricao:o==null?void 0:o.descricao,data:o==null?void 0:o.data,escolaId:e==null?void 0:e.id,fotoUrl:d==null?void 0:d.id,fotoUrl2:u==null?void 0:u.id,fotoUrl3:x==null?void 0:x.id,fotoUrl4:N==null?void 0:N.id},no=await f.post("/history/post",Y)}}if((e==null?void 0:e.Localizacao)===null){const m={endereco1:o==null?void 0:o.endereco1,provinciaId:o==null?void 0:o.provinciaId,municipioId:o==null?void 0:o.municipioId,escolaId:e==null?void 0:e.id},t=await f.post("/location/post",m)}else{const m={endereco1:o==null?void 0:o.endereco1,provinciaId:o==null?void 0:o.provinciaId,municipioId:o==null?void 0:o.municipioId,escolaId:e==null?void 0:e.id},t=await f.put(`/location/put/${o==null?void 0:o.localizacaoId}`,m)}if(e!=null&&e.Contato){const m={email:o==null?void 0:o.email,telefone:o==null?void 0:o.numeroTelefone},t=(await f.put(`/contact/put/${o==null?void 0:o.contatoId}`,m)).data;c=t==null?void 0:t.id}else{const m={email:o==null?void 0:o.email,telefone:o==null?void 0:o.numeroTelefone},t=await f.post("/contact/post",m)}const h=new FormData,J=new FormData;h.append("file",o==null?void 0:o.logo[0]),J.append("file",o==null?void 0:o.fotoUrl[0]);const F=await a(h),C=await a(J),X={fotoUrl:C==null?void 0:C.id,logo:F==null?void 0:F.id,nome:o==null?void 0:o.nome,nif:o==null?void 0:o.nif,contatoId:c};await f.put(`/school/put/${e==null?void 0:e.id}`,X)&&O.success("Dados actualizados com sucesso!")}catch(h){O.error((W=(Q=h==null?void 0:h.response)==null?void 0:Q.data)==null?void 0:W.message)}}});async function a(o){return(await f.post("/file",o)).data}return console.log(l.errors),r(_,{children:r(oo,{sm:"12",lg:"12",children:i(w,{children:[r(w.Header,{className:"d-flex justify-content-between",children:r("div",{className:"header-title",children:r("h4",{className:"card-title",children:"Configurar Perfil da Institui\xE7\xE3o"})})}),r(w.Body,{children:i(n,{id:"form-wizard1",className:"text-center mt-3",onSubmit:l.handleSubmit,encType:"multipart/form-data",children:[i("div",{className:"form-card text-start",children:[r("div",{className:"row",children:r("div",{className:"col-7",children:r("h3",{className:"mb-4",children:"Informa\xE7\xF5es da Escola: "})})}),i("div",{className:"row",children:[r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Email da Escola: *"}),r("input",{type:"email",className:"form-control",name:"email",id:"email",value:l.values.email,onChange:l.handleChange,placeholder:"E-mail"})]})}),r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Nome da Escola: *"}),r("input",{type:"text",className:"form-control",name:"nome",placeholder:"Nome",onChange:l.handleChange,value:l.values.nome,id:"nome"})]})}),r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"NIF"}),r("input",{type:"text",className:"form-control",name:"nif",id:"nif",value:l.values.nif,onChange:l.handleChange,placeholder:"nif"})]})}),r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Telefone: *"}),r("input",{type:"text",className:"form-control",name:"numeroTelefone",id:"numeroTelefone",onChange:l.handleChange,value:l.values.numeroTelefone,placeholder:"Tel"})]})}),r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Prov\xEDncia"}),i(n.Select,{name:"provinciaId",id:"provinciaId",onChange:l.handleChange,value:l.values.provinciaId,children:[r("option",{defaultChecked:!0,children:"Selecione uma provic\xEDncia"}),b==null?void 0:b.map(o=>r("option",{value:o==null?void 0:o.id,children:o==null?void 0:o.nome},o==null?void 0:o.id))]})]})}),r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Endere\xE7o"}),r("input",{type:"text",className:"form-control",name:"endereco1",id:"endereco1",value:l.values.endereco1,onChange:l.handleChange,placeholder:"endere\xE7o"})]})}),r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Munic\xEDpio"}),i(n.Select,{name:"municipioId",id:"municipioId",onChange:l.handleChange,value:l.values.municipioId,children:[r("option",{defaultChecked:!0,children:"Selecione um munic\xEDpio"}),I==null?void 0:I.map(o=>r("option",{value:o==null?void 0:o.id,children:o==null?void 0:o.nome},o==null?void 0:o.id))]})]})})]})]}),i("div",{className:"form-card text-start",children:[r("div",{className:"row",children:r("div",{className:"col-7",children:r("h3",{className:"mb-4 mt-4",children:"Informa\xE7\xF5es sobre o Historial"})})}),i("div",{className:"row",children:[r("div",{className:"col-md-6",children:i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Nome Fundador: *"}),r("input",{type:"text",className:"form-control",name:"fundador",id:"fundador",placeholder:"fundador",value:l.values.fundador,onChange:l.handleChange})]})}),r("div",{className:"col-md-6",children:i(n.Group,{className:"form-group",children:[r(n.Label,{htmlFor:"exampleInputdatetime",children:"Data da Funda\xE7\xE3o"}),r(n.Control,{type:"date",id:"data",name:"data",value:l.values.data,onChange:l.handleChange})]})}),r("div",{className:"col-md-6",children:i(n.Group,{className:"form-group",children:[r(n.Label,{htmlFor:"exampleInputdatetime",children:"Escolher Imagem (1)"}),r(n.Control,{type:"file",name:"fotoUrl1",id:"fotoUrl1",onChange:o=>{var c;l.setFieldValue("fotoUrl1",(c=o==null?void 0:o.currentTarget)==null?void 0:c.files)}})]})}),r("div",{className:"col-md-6",children:i(n.Group,{className:"form-group",children:[r(n.Label,{htmlFor:"exampleInputdatetime",children:"Escolher Imagem (2)"}),r(n.Control,{type:"file",name:"fotoUrl2",id:"fotoUrl2",onChange:o=>{var c;l.setFieldValue("fotoUrl2",(c=o==null?void 0:o.currentTarget)==null?void 0:c.files)}})]})}),r("div",{className:"col-md-6",children:i(n.Group,{className:"form-group",children:[r(n.Label,{htmlFor:"exampleInputdatetime",children:"Escolher Imagem (3)"}),r(n.Control,{type:"file",name:"fotoUrl3",id:"fotoUrl3",onChange:o=>{var c;l.setFieldValue("fotoUrl3",(c=o==null?void 0:o.currentTarget)==null?void 0:c.files)}})]})}),r("div",{className:"col-md-6",children:i(n.Group,{className:"form-group",children:[r(n.Label,{htmlFor:"exampleInputdatetime",children:"Escolher Imagem (4)"}),r(n.Control,{type:"file",id:"fotoUrl4",name:"fotoUrl4",onChange:o=>{var c;l.setFieldValue("fotoUrl4",(c=o==null?void 0:o.currentTarget)==null?void 0:c.files)}})]})}),i(n.Group,{className:"mb-3 form-group",children:[r(n.Label,{htmlFor:"exampleFormControlTextarea1",children:"Descri\xE7\xE3o"}),r(n.Control,{as:"textarea",name:"descricao",onChange:l.handleChange,id:"descricao",rows:"5"})]})]})]}),i("div",{className:"form-card text-start",children:[r("div",{className:"row",children:r("div",{className:"col-7",children:r("h3",{className:"mb-4 mt-3",children:"Carregamento de imagem:"})})}),i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Logo:"}),r(n.Control,{type:"file",name:"logo",id:"logo",onChange:o=>{var c;l.setFieldValue("logo",(c=o==null?void 0:o.currentTarget)==null?void 0:c.files)}})]}),i("div",{className:"form-group",children:[r("label",{className:"form-label",children:"Imagem de Perfil:"}),r(n.Control,{type:"file",name:"fotoUrl",id:"fotoUrl",onChange:o=>{var c;l.setFieldValue("fotoUrl",(c=o==null?void 0:o.currentTarget)==null?void 0:c.files)}})]})]}),r("button",{type:"submit",className:"btn btn-primary next action-button float-end",children:"Salvar"})]})})]})})})};export{mo as default};
