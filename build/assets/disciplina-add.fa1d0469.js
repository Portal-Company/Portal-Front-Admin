import{u as B,c as G,a as d}from"./index.esm.997dd77f.js";import{g as T,u as w,a as S,Q as q,j as r,R as j,b as o,C as h,F as s,c as L,B as R}from"./index.3b1adc00.js";const z=()=>{var m,p,b,g,x,C,F,N,E,I,y,U,v;const i=T(),{data:l}=w(`/user/list/${i==null?void 0:i.sub}`),{data:u}=w(`/school/list/${(m=l==null?void 0:l.Escola)==null?void 0:m.id}/courses`),e=B({initialValues:{nome:"",fotoUrl:"",descricao:"",cursoId:"",escolaId:""},validationSchema:G({nome:d().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:d().required("Este campo  \xE9 obrigat\xF3rio"),descricao:d().required("Este campo \xE9 obrigat\xF3rio"),cursoId:d().required("Este campo \xE9 obrigat\xF3rio")}),onSubmit:async a=>{var c,D,f;try{const n=new FormData;n.append("file",a==null?void 0:a.fotoUrl[0]);const t=await $(n);t&&(a={...a,fotoUrl:t==null?void 0:t.id,escolaId:(c=l==null?void 0:l.Escola)==null?void 0:c.id},await S.post("/schoolSubject/post",a)&&(q.success("Disciplina cadastrada com sucesso"),e.resetForm()))}catch(n){q.error((f=(D=n==null?void 0:n.response)==null?void 0:D.data)==null?void 0:f.message)}}});async function $(a){return(await S.post("/file",a)).data}return r(j,{children:o(h,{children:[r(h.Header,{className:"d-flex justify-content-between",children:r("div",{className:"header-title",children:r("h4",{className:"card-title",children:" Cadastrar Disciplina"})})}),r(h.Body,{children:o(s,{onSubmit:e.handleSubmit,encType:"multipart/form-data",children:[o(j,{children:[o(L,{md:"6",className:"mb-3",children:[r(s.Label,{htmlFor:"validationDefault04",children:"Curso"}),o(s.Select,{id:"cursoId",name:"cursoId",value:e.values.cursoId,required:!0,onChange:e.handleChange,children:[r("option",{defaultChecked:!0,children:"Selecione um curso"}),u==null?void 0:u.map(a=>r("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nome},a==null?void 0:a.id))]}),((p=e==null?void 0:e.touched)==null?void 0:p.cursoId)&&((b=e==null?void 0:e.errors)==null?void 0:b.cursoId)?r("label",{className:"mt-1 text-danger",children:(g=e==null?void 0:e.errors)==null?void 0:g.cursoId}):null,o(s.Group,{className:"mb-3 form-group mt-2",children:[r(s.Label,{htmlFor:"exampleFormControlTextarea1",children:"Descri\xE7\xE3o"}),r(s.Control,{as:"textarea",id:"descricao",value:e.values.descricao,name:"descricao",onChange:e.handleChange,rows:"5"}),((x=e==null?void 0:e.touched)==null?void 0:x.descricao)&&((C=e==null?void 0:e.errors)==null?void 0:C.descricao)?r("label",{className:"mt-1 text-danger",children:(F=e==null?void 0:e.errors)==null?void 0:F.descricao}):null]})]}),o(L,{md:"6",className:"mb-3",children:[r(s.Label,{md:"6",htmlFor:"validationDefault01",children:"Nome da Disciplina"}),r(s.Control,{type:"text",id:"nome",name:"nome",value:e.values.nome,onChange:e.handleChange,required:!0}),((N=e==null?void 0:e.touched)==null?void 0:N.nome)&&((E=e==null?void 0:e.errors)==null?void 0:E.nome)?r("label",{className:"mt-1 text-danger",children:(I=e==null?void 0:e.errors)==null?void 0:I.nome}):null,o(s.Group,{className:"mb-3 form-group mt-2",children:[r(s.Label,{className:"custom-file-input",children:"Carregar imagem"}),r(s.Control,{type:"file",id:"fotoUrl",name:"fotoUrl",onChange:a=>{var c;e.setFieldValue("fotoUrl",(c=a==null?void 0:a.currentTarget)==null?void 0:c.files)}}),((y=e==null?void 0:e.touched)==null?void 0:y.fotoUrl)&&((U=e==null?void 0:e.errors)==null?void 0:U.fotoUrl)?r("label",{className:"mt-1 text-danger",children:(v=e==null?void 0:e.errors)==null?void 0:v.fotoUrl}):null]})]})]}),r(s.Group,{children:r(R,{variant:"btn btn-primary",type:"submit",children:"Cadastrar"})})]})})]})})};export{z as default};
