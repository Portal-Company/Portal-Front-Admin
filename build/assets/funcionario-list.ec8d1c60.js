import{g as ee,u as F,a as m,Q as v,b as t,j as o,d as ne,F as l,e as re,c as oe,B as P,a4 as ae,I as le,L as X,r as w,R as te,C as Y,m as se}from"./index.3b1adc00.js";import{M as de}from"./index.ef0c42f4.js";import{u as ce,c as ue,a as p}from"./index.esm.997dd77f.js";import{M as S}from"./Modal.63283be8.js";import{T as he}from"./Table.58b31dea.js";function ie({onClose:r,item:n,mutate:f,setShowModalUpadate:g}){var L,I,y,N,d,i,q,D,U,$,_,T,B,j,G,H,W,z,A,V,R,k,Q;const u=ee(),{data:x}=F(`/user/list/${u==null?void 0:u.sub}`),{data:h}=F("/role/list/"),s=[{nome:"Masculino",value:"M"},{nome:"Femenino",value:"F"}],e=ce({initialValues:{nome:n==null?void 0:n.nome,fotoUrl:n==null?void 0:n.fotoUrl,sexo:n==null?void 0:n.sexo,telefone:(L=n==null?void 0:n.Contato)==null?void 0:L.numeroTelefone,email:(I=n==null?void 0:n.Contato)==null?void 0:I.email,cargoId:n==null?void 0:n.cargoId,departamentoId:n==null?void 0:n.departamentoId,numero_agente:n==null?void 0:n.agenteN,contatoId:n==null?void 0:n.contatoId},validationSchema:ue({nome:p().required("Este campo \xE9 obrigat\xF3rio"),fotoUrl:p().required("Este campo  \xE9 obrigat\xF3rio"),email:p().email().required("Este campo \xE9 obrigat\xF3rio"),cargoId:p().required("Este campo \xE9 obrigat\xF3rio"),sexo:p().required("Este campo \xE9 obrigat\xF3rio"),contatoId:p().required("Este campo \xE9 obrigat\xF3rio"),departamentoId:p().required("Este campo \xE9 obrigat\xF3rio"),numero_agente:p().required("Este campo \xE9 obrigat\xF3rio"),telefone:p().required("Este campo \xE9 obrigat\xF3rio")}),onSubmit:async a=>{var C,Z,J,K;if((n==null?void 0:n.fotoUrl)===(a==null?void 0:a.fotoUrl))try{const c={email:a.email,numeroTelefone:a.telefone.toString()},b=await(await m.put(`/contact/put/${n==null?void 0:n.contatoId}`,c)).data;a={...a,contatoId:b==null?void 0:b.id,numero_agente:a.numero_agente.toString(),sexo:a.sexo},await m.put(`/official/put/${n==null?void 0:n.id}`,a)&&(v.success("Funcionario actualizado com sucesso"),f(),g(!1))}catch(c){v.error((Z=(C=c==null?void 0:c.response)==null?void 0:C.data)==null?void 0:Z.message)}else try{const c=new FormData;c.append("file",a==null?void 0:a.fotoUrl[0]);const b=await E(c);if(b){const O={email:a.email,numeroTelefone:a.telefone.toString()},M=await(await m.put(`/contact/put/${n==null?void 0:n.contatoId}`,O)).data;a={...a,contatoId:M==null?void 0:M.id,numero_agente:a.numero_agente.toString(),sexo:a.sexo,fotoUrl:b==null?void 0:b.id},await m.put(`/official/put/${n==null?void 0:n.id}`,a)&&(v.success("Funcion\xE1rio actualizado com sucesso"),g(!1))}}catch(c){v.error((K=(J=c==null?void 0:c.response)==null?void 0:J.data)==null?void 0:K.message)}}});async function E(a){return(await m.post("/file",a)).data}return t(S,{show:!0,onHide:r,children:[o(S.Header,{closeButton:!0,children:o(S.Title,{children:"Actualizar Funcion\xE1rio"})}),o(ne.Body,{style:{width:"100%",padding:"1rem 1rem",display:"flex"},children:t(l,{onSubmit:e==null?void 0:e.handleSubmit,encType:"multipart/form-data",children:[o(re,{children:t(oe,{xs:12,sm:12,md:12,lg:50,xl:20,className:"mb-3 ",children:[o(l.Label,{htmlFor:"validationCustom05",children:"Nome"}),o(l.Control,{onChange:e.handleChange,name:"nome",value:e.values.nome,type:"text",id:"nome"}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{md:"6",htmlFor:"validationDefault01",children:"Email"}),o(l.Control,{type:"text",id:"email",name:"email",value:e.values.email,onChange:e.handleChange,required:!0}),((y=e==null?void 0:e.touched)==null?void 0:y.email)&&((N=e==null?void 0:e.errors)==null?void 0:N.email)?o("label",{className:"mt-1 text-danger",children:(d=e==null?void 0:e.errors)==null?void 0:d.email}):null]}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{md:"6",htmlFor:"validationDefault01",children:"N\xBA Agente"}),o(l.Control,{type:"number",id:"numero_agente",name:"numero_agente",value:e.values.numero_agente,onChange:e.handleChange,required:!0}),((i=e==null?void 0:e.touched)==null?void 0:i.numero_agente)&&((q=e==null?void 0:e.errors)==null?void 0:q.numero_agente)?o("label",{className:"mt-1 text-danger",children:(D=e==null?void 0:e.errors)==null?void 0:D.numero_agente}):null]}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{md:"6",htmlFor:"validationDefault01",children:"Telefone"}),o(l.Control,{type:"number",id:"telefone",name:"telefone",value:e.values.telefone,onChange:e.handleChange,required:!0}),((U=e==null?void 0:e.touched)==null?void 0:U.telefone)&&(($=e==null?void 0:e.errors)==null?void 0:$.telefone)?o("label",{className:"mt-1 text-danger",children:(_=e==null?void 0:e.errors)==null?void 0:_.telefone}):null]}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{htmlFor:"validationDefault04",children:"Genero"}),t(l.Select,{id:"sexo",name:"sexo",required:!0,value:e.values.sexo,onChange:e.handleChange,children:[o("option",{defaultChecked:!0,children:"Selecione o sexo"}),s==null?void 0:s.map((a,C)=>o("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.nome},C))]}),((T=e==null?void 0:e.touched)==null?void 0:T.sexo)&&((B=e==null?void 0:e.errors)==null?void 0:B.sexo)?o("label",{className:"mt-1 text-danger",children:(j=e==null?void 0:e.errors)==null?void 0:j.sexo}):null]}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{htmlFor:"validationDefault04",children:"Departamento"}),t(l.Select,{id:"departamentoId",name:"departamentoId",required:!0,value:e.values.departamentoId,onChange:e.handleChange,children:[o("option",{defaultChecked:!0,children:"Selecione o departamento"}),(W=(H=(G=x==null?void 0:x.Escola)==null?void 0:G.Organigrama)==null?void 0:H.Departamento)==null?void 0:W.map(a=>o("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nome},a==null?void 0:a.id))]}),((z=e==null?void 0:e.touched)==null?void 0:z.departamentoId)&&((A=e==null?void 0:e.errors)==null?void 0:A.departamentoId)?o("label",{className:"mt-1 text-danger",children:(V=e==null?void 0:e.errors)==null?void 0:V.departamentoId}):null]}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{htmlFor:"validationDefault04",children:"Cargo"}),t(l.Select,{id:"departamentoId",name:"departamentoId",required:!0,value:e.values.cargoId,onChange:e.handleChange,children:[o("option",{defaultChecked:!0,children:"Selecione o departamento"}),h==null?void 0:h.map(a=>o("option",{value:a==null?void 0:a.id,children:a==null?void 0:a.nome},a==null?void 0:a.id))]}),((R=e==null?void 0:e.touched)==null?void 0:R.departamentoId)&&((k=e==null?void 0:e.errors)==null?void 0:k.departamentoId)?o("label",{className:"mt-1 text-danger",children:(Q=e==null?void 0:e.errors)==null?void 0:Q.departamentoId}):null]}),t(l.Group,{className:"mb-3 form-group mt-2",children:[o(l.Label,{className:"custom-file-input",children:"Escolher foto"}),o(l.Control,{type:"file",id:"fotoUrl",name:"fotoUrl",onChange:a=>{var C;e.setFieldValue("fotoUrl",(C=a==null?void 0:a.currentTarget)==null?void 0:C.files)}})]})]})}),t(S.Footer,{children:[o(P,{variant:"secondary",onClick:r,children:"Cancelar"}),o(P,{type:"submit",children:"Actualizar"})]})]})})]})}function pe({item:r,handleUpdate:n,handleDelete:f}){var u,x,h,s,e;const{data:g}=F(`/file/${r==null?void 0:r.fotoUrl}`);return o(ae,{children:t("tr",{children:[o("td",{children:t("div",{className:"d-flex align-items-center",children:[o(le,{className:"rounded img-fluid w-25 me-3",src:g==null?void 0:g.link,loading:"lazy",alt:""}),o("div",{className:"media-support-info",children:o("h6",{className:"mb-0",children:r==null?void 0:r.nome})})]})}),o("td",{className:"text-dark",children:(u=r==null?void 0:r.Contato)==null?void 0:u.numeroTelefone}),o("td",{className:"text-dark",children:(x=r==null?void 0:r.Contato)==null?void 0:x.email}),o("td",{className:"text-dark",children:r==null?void 0:r.sexo}),o("td",{className:"text-dark",children:(h=r==null?void 0:r.Cargo)==null?void 0:h.nome}),o("td",{className:"text-dark",children:(s=r==null?void 0:r.Departamento)!=null&&s.nome?(e=r==null?void 0:r.Departamento)==null?void 0:e.nome:"sem departamento"}),o("td",{children:t("div",{className:"flex align-items-center list-user-action",children:[o(X,{onClick:()=>n(r),className:"btn btn-sm btn-icon btn-warning","data-toggle":"tooltip","data-placement":"top",title:"","data-original-title":"Edit",to:"#",children:o("span",{className:"btn-inner",children:t("svg",{width:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o("path",{d:"M11.4925 2.78906H7.75349C4.67849 2.78906 2.75049 4.96606 2.75049 8.04806V16.3621C2.75049 19.4441 4.66949 21.6211 7.75349 21.6211H16.5775C19.6625 21.6211 21.5815 19.4441 21.5815 16.3621V12.3341",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.82812 10.921L16.3011 3.44799C17.2321 2.51799 18.7411 2.51799 19.6721 3.44799L20.8891 4.66499C21.8201 5.59599 21.8201 7.10599 20.8891 8.03599L13.3801 15.545C12.9731 15.952 12.4211 16.181 11.8451 16.181H8.09912L8.19312 12.401C8.20712 11.845 8.43412 11.315 8.82812 10.921Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o("path",{d:"M15.1655 4.60254L19.7315 9.16854",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})})," ",o(X,{onClick:()=>f(r),className:"btn btn-sm btn-icon btn-danger","data-toggle":"tooltip","data-placement":"top",title:"","data-original-title":"Delete",to:"#",children:o("span",{className:"btn-inner",children:t("svg",{width:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",children:[o("path",{d:"M19.3248 9.46826C19.3248 9.46826 18.7818 16.2033 18.4668 19.0403C18.3168 20.3953 17.4798 21.1893 16.1088 21.2143C13.4998 21.2613 10.8878 21.2643 8.27979 21.2093C6.96079 21.1823 6.13779 20.3783 5.99079 19.0473C5.67379 16.1853 5.13379 9.46826 5.13379 9.46826",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o("path",{d:"M20.708 6.23975H3.75",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),o("path",{d:"M17.4406 6.23973C16.6556 6.23973 15.9796 5.68473 15.8256 4.91573L15.5826 3.69973C15.4326 3.13873 14.9246 2.75073 14.3456 2.75073H10.1126C9.53358 2.75073 9.02558 3.13873 8.87558 3.69973L8.63258 4.91573C8.47858 5.68473 7.80258 6.23973 7.01758 6.23973",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})})," "]})})]})})}const ge=w.exports.memo(()=>{var N;const r=ee(),[n,f]=w.exports.useState({}),[g,u]=w.exports.useState(!1),[x,h]=w.exports.useState(!1),{data:s}=F(`/user/list/${r==null?void 0:r.sub}`),{data:e}=F(`/school/list/${(N=s==null?void 0:s.Escola)==null?void 0:N.id}/official`);function E(){var d;se(`/school/list/${(d=s==null?void 0:s.Escola)==null?void 0:d.id}/official`)}async function L(d){try{const i=await m.delete(`official/delete/${d}`);i!=null&&i.data&&(v.success("deletado com sucesso!"),E(),u(!1))}catch{v.error("Erro inesperado")}}function I(d){u(!0),f(d)}function y(d){h(!0),f(d)}return t(w.exports.Fragment,{children:[x?o(ie,{onClose:()=>h(!1),setShowModalUpadate:h,mutate:E,item:n}):null,g?o(de,{onClose:()=>u(!1),onConfirm:()=>L(n==null?void 0:n.id),item:n}):null,o(te,{children:o(oe,{lg:"12",children:o(Y,{children:o(Y.Body,{children:o("div",{className:"custom-table-effect table-responsive border rounded mt-3",children:t(he,{className:"mb-0",id:"datatable","data-toggle":"data-table",children:[o("thead",{children:t("tr",{className:"bg-white",children:[o("th",{scope:"col",children:"Nome"}),o("th",{scope:"col",children:"Contacto"}),o("th",{scope:"col",children:"Email"}),o("th",{scope:"col",children:"Sexo"}),o("th",{scope:"col",children:"Cargo"}),o("th",{scope:"col",children:"Departamento"}),o("th",{scope:"col",children:"Ac\xE7\xE3o"})]})}),o("tbody",{children:e==null?void 0:e.map((d,i)=>o(ae,{children:o(pe,{item:d,handleUpdate:y,handleDelete:I},i)}))})]})})})})})})]})});ge.displayName="Borderedtable";export{ge as default};
